<!-- Cookie Consent Banner -->
<div id="cookieConsent" class="fixed bottom-0 left-0 right-0 bg-white border-t-2 border-[var(--color-primary)] shadow-lg z-50 hidden">
    <div class="container-custom py-4">
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
            <div class="flex-1">
                <h3 class="font-bold text-lg mb-2">üç™ Cookie Consent</h3>
                <p class="text-sm text-[var(--color-text-medium)]">
                    We use cookies to enhance your experience, analyze site traffic, and serve personalized content and ads. 
                    By continuing to use this site, you consent to our use of cookies and agree to our 
                    <a href="/Home/Privacy" class="text-[var(--color-primary)] hover:underline">Privacy Policy</a>.
                </p>
            </div>
            <div class="flex gap-3 flex-shrink-0">
                <button onclick="acceptCookies()" class="btn btn-primary px-6 py-2">
                    Accept All
                </button>
                <button onclick="showCookieSettings()" class="btn btn-outline px-6 py-2">
                    Settings
                </button>
                <button onclick="declineCookies()" class="btn btn-outline px-6 py-2">
                    Decline
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Cookie Settings Modal -->
<div id="cookieSettingsModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="card max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-2xl font-bold">Cookie Preferences</h2>
            <button onclick="closeCookieSettings()" class="text-2xl hover:text-[var(--color-primary)]">&times;</button>
        </div>

        <div class="space-y-6">
            <!-- Necessary Cookies -->
            <div class="border-b border-[var(--color-border)] pb-4">
                <div class="flex justify-between items-center mb-2">
                    <div>
                        <h3 class="font-bold">Strictly Necessary Cookies</h3>
                        <p class="text-sm text-[var(--color-text-medium)] mt-1">
                            These cookies are essential for the website to function properly. They enable core functionality such as security, 
                            network management, and accessibility.
                        </p>
                    </div>
                    <label class="inline-flex items-center ml-4">
                        <input type="checkbox" checked disabled class="form-checkbox" />
                        <span class="ml-2 text-sm text-[var(--color-text-medium)]">Always Active</span>
                    </label>
                </div>
            </div>

            <!-- Analytics Cookies -->
            <div class="border-b border-[var(--color-border)] pb-4">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex-1">
                        <h3 class="font-bold">Analytics Cookies</h3>
                        <p class="text-sm text-[var(--color-text-medium)] mt-1">
                            These cookies help us understand how visitors interact with our website. We use this data to improve 
                            our content and user experience.
                        </p>
                    </div>
                    <label class="inline-flex items-center ml-4">
                        <input type="checkbox" id="analyticsConsent" class="form-checkbox" />
                        <span class="ml-2 text-sm">Enable</span>
                    </label>
                </div>
            </div>

            <!-- Advertising Cookies -->
            <div class="border-b border-[var(--color-border)] pb-4">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex-1">
                        <h3 class="font-bold">Advertising Cookies</h3>
                        <p class="text-sm text-[var(--color-text-medium)] mt-1">
                            These cookies are used to deliver ads that are relevant to you. They also limit the number of times 
                            you see an ad and help us measure the effectiveness of advertising campaigns.
                        </p>
                    </div>
                    <label class="inline-flex items-center ml-4">
                        <input type="checkbox" id="advertisingConsent" class="form-checkbox" />
                        <span class="ml-2 text-sm">Enable</span>
                    </label>
                </div>
            </div>

            <!-- Personalization Cookies -->
            <div class="pb-4">
                <div class="flex justify-between items-start mb-2">
                    <div class="flex-1">
                        <h3 class="font-bold">Personalization Cookies</h3>
                        <p class="text-sm text-[var(--color-text-medium)] mt-1">
                            These cookies allow the website to remember choices you make (such as your theme preference) 
                            and provide enhanced, more personal features.
                        </p>
                    </div>
                    <label class="inline-flex items-center ml-4">
                        <input type="checkbox" id="personalizationConsent" class="form-checkbox" />
                        <span class="ml-2 text-sm">Enable</span>
                    </label>
                </div>
            </div>
        </div>

        <div class="flex gap-3 justify-end mt-6 pt-6 border-t border-[var(--color-border)]">
            <button onclick="closeCookieSettings()" class="btn btn-outline">Cancel</button>
            <button onclick="saveDeclineCookies()" class="btn btn-outline">Decline All</button>
            <button onclick="saveCookiePreferences()" class="btn btn-primary">Save Preferences</button>
        </div>
    </div>
</div>

<script>
    // Cookie consent management
    (function() {
        // Check if consent has been given
        const cookieConsent = localStorage.getItem('cookieConsent');
        
        if (!cookieConsent) {
            // Show banner after short delay
            setTimeout(() => {
                document.getElementById('cookieConsent').classList.remove('hidden');
            }, 1000);
        } else {
            // Load user preferences
            loadCookiePreferences();
        }
    })();

    function acceptCookies() {
        const preferences = {
            necessary: true,
            analytics: true,
            advertising: true,
            personalization: true,
            timestamp: new Date().toISOString()
        };
        
        localStorage.setItem('cookieConsent', JSON.stringify(preferences));
        document.getElementById('cookieConsent').classList.add('hidden');
        
        // Initialize tracking scripts
        initializeAnalytics();
        initializeAdvertising();
        
        console.log('All cookies accepted');
    }

    function declineCookies() {
        const preferences = {
            necessary: true,
            analytics: false,
            advertising: false,
            personalization: false,
            timestamp: new Date().toISOString()
        };
        
        localStorage.setItem('cookieConsent', JSON.stringify(preferences));
        document.getElementById('cookieConsent').classList.add('hidden');
        
        console.log('Non-essential cookies declined');
    }

    function showCookieSettings() {
        // Load current preferences if any
        const savedPrefs = JSON.parse(localStorage.getItem('cookieConsent') || '{}');
        
        document.getElementById('analyticsConsent').checked = savedPrefs.analytics !== false;
        document.getElementById('advertisingConsent').checked = savedPrefs.advertising !== false;
        document.getElementById('personalizationConsent').checked = savedPrefs.personalization !== false;
        
        document.getElementById('cookieSettingsModal').classList.remove('hidden');
    }

    function closeCookieSettings() {
        document.getElementById('cookieSettingsModal').classList.add('hidden');
    }

    function saveDeclineCookies() {
        declineCookies();
        closeCookieSettings();
    }

    function saveCookiePreferences() {
        const preferences = {
            necessary: true,
            analytics: document.getElementById('analyticsConsent').checked,
            advertising: document.getElementById('advertisingConsent').checked,
            personalization: document.getElementById('personalizationConsent').checked,
            timestamp: new Date().toISOString()
        };
        
        localStorage.setItem('cookieConsent', JSON.stringify(preferences));
        document.getElementById('cookieConsent').classList.add('hidden');
        document.getElementById('cookieSettingsModal').classList.add('hidden');
        
        // Initialize services based on preferences
        if (preferences.analytics) {
            initializeAnalytics();
        }
        if (preferences.advertising) {
            initializeAdvertising();
        }
        
        console.log('Cookie preferences saved:', preferences);
    }

    function loadCookiePreferences() {
        const preferences = JSON.parse(localStorage.getItem('cookieConsent') || '{}');
        
        if (preferences.analytics) {
            initializeAnalytics();
        }
        if (preferences.advertising) {
            initializeAdvertising();
        }
    }

    function initializeAnalytics() {
        // Google Analytics initialization
        // This will be loaded conditionally based on user consent
        if (typeof gtag !== 'undefined') {
            console.log('Analytics initialized');
        }
    }

    function initializeAdvertising() {
        // AdSense/advertising initialization
        // This will be loaded conditionally based on user consent
        console.log('Advertising initialized');
    }

    // Expose function to reopen settings
    window.openCookieSettings = function() {
        showCookieSettings();
    };
</script>

<style>
    #cookieConsent {
        animation: slideUp 0.3s ease-out;
    }

    @@keyframes slideUp {
        from {
            transform: translateY(100%);
            opacity: 0;
        }
        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    .form-checkbox {
        width: 1.25rem;
        height: 1.25rem;
        border-radius: 0.25rem;
        border: 2px solid var(--color-border);
        cursor: pointer;
    }

    .form-checkbox:checked {
        background-color: var(--color-primary);
        border-color: var(--color-primary);
    }

    .form-checkbox:disabled {
        opacity: 0.5;
        cursor: not-allowed;
    }
</style>
